version: 1
frontend:
  phases:
    preBuild:
      commands:
        - |
          if git diff --name-only $AWS_COMMIT_ID $AWS_PREV_COMMIT_ID | grep -q '^frontend/'; then
            echo "Frontend changes detected"
          else
            echo "No frontend changes, skipping build"
            exit 0
          fi
        - cd frontend
        - npm ci
    build:
      commands:
        - npm run build
  artifacts:
    baseDirectory: frontend/dist
    files:
      - '**/*'
  cache:
    paths:
      - frontend/node_modules/**/*
